<div class="rnk-log-viewer-container">
  <form class="rnk-log-viewer">
    <header>
      <h2>Hero Points Activity Log</h2>
      <div class="log-controls">
        <select class="rnk-filter-actor">
          <option value="">All Actors</option>
          {{#each summary}}
            <option value="{{this.id}}">{{this.name}}</option>
          {{/each}}
        </select>
        <button type="button" class="rnk-export-log" title="Export log as JSON">
          <i class="fas fa-download"></i> Export
        </button>
        <button type="button" class="rnk-clear-all-log" title="Clear all logs permanently">
          <i class="fas fa-trash"></i> Clear All
        </button>
      </div>
    </header>

    <section class="log-summary">
      <h3>Current Summary</h3>
      <p>Total Entries: <strong>{{totalEntries}}</strong> | Total Points Spent: <strong>{{totalSpent}}</strong></p>
      <table class="rnk-summary-table">
        <thead>
          <tr>
            <th>Actor</th>
            <th>Type</th>
            <th>Current Points</th>
            <th>Last Activity</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {{#each summary}}
            <tr>
              <td>{{this.name}}</td>
              <td>{{this.type}}</td>
              <td class="text-center"><strong>{{this.heroPoints}}</strong></td>
              <td class="text-small">
                {{#if this.lastSpend}}
                  {{this.lastSpend.action}} - {{this.lastSpend.date}}
                {{else}}
                  Never
                {{/if}}
              </td>
              <td class="text-center">
                <button type="button" class="rnk-clear-actor-log" data-actor-id="{{this.id}}" data-actor-name="{{this.name}}" title="Clear logs for this actor">
                  <i class="fas fa-trash-alt"></i>
                </button>
              </td>
            </tr>
          {{/each}}
        </tbody>
      </table>
    </section>

    <section class="log-entries">
      <h3>Recent Activity</h3>
      {{#if entries}}
        <table class="rnk-log-table">
          <thead>
            <tr>
              <th>Date</th>
              <th>Actor</th>
              <th>Action</th>
              <th>Points Spent</th>
              <th>Points Remaining</th>
              <th>By</th>
            </tr>
          </thead>
          <tbody>
            {{#each entries}}
              <tr data-actor-id="{{this.actorId}}" class="log-entry">
                <td class="text-small">{{this.date}}</td>
                <td><strong>{{this.actorName}}</strong></td>
                <td>{{this.action}}</td>
                <td class="text-center">{{this.pointsSpent}}</td>
                <td class="text-center"><strong>{{this.pointsRemaining}}</strong></td>
                <td class="text-small">{{this.userName}}</td>
              </tr>
            {{/each}}
          </tbody>
        </table>
      {{else}}
        <p class="text-center text-muted">No activity logged yet.</p>
      {{/if}}
    </section>
  </form>
</div>
